# RPG어드벤처 (잊혀진 영역의 연대기)

## 소개

RPG어드벤처는 사용자가 자신만의 시나리오를 가져와 플레이할 수 있는 텍스트 및 차트 기반의 JRPG 엔진입니다. 
기본으로 등록된 시나리오인 [잊혀진 영역의 연대기]는 RPG스크립트에디터(https://rpg-script-editor.vercel.app) 를 이용해 생성한 시나리오입니다.
플레이어는 기본 시나리오 외에 RPG스크립트에디터로 생성한 JSON 형식의 스크립트를 통해 자신만의 모험을 만들어 사용할 수 있습니다.

실행 주소 : https://dev-canvas-pi.vercel.app/

## 주요 기능

*   **스크립트 기반 게임 플레이**: JSON 형식의 스크립트를 통해 게임의 세계관, 스테이지, 장면, 캐릭터, 아이템, 스킬 등을 정의하고 커스텀 모험을 만들 수 있습니다.
*   **턴제 전투 시스템**:
    *   플레이어와 적들이 번갈아 가며 공격, 스킬 사용, 아이템 사용, 도망 등의 행동을 취하는 클래식한 턴제 전투를 지원합니다.
    *   **치명타 및 빗나감**: 캐릭터의 능력치(행운, 치명타 확률)에 따라 공격이 치명타로 적중하거나 빗나갈 수 있어 전투에 변수를 더합니다.
    *   **속도 기반 턴 순서**: 전투 시작 시 및 매 라운드 시작 시, 캐릭터의 속도 능력치에 따라 행동 순서가 결정됩니다.
    *   **적 스킬 사용 AI**: 적 캐릭터들도 다양한 스킬을 사용하며, 플레이어에게 도전적인 전투 경험을 제공합니다.
*   **캐릭터 성장**: 레벨, 경험치, HP, MP, 공격력, 방어력, 속도, 행운, 치명타 확률 등 다양한 능력치를 관리하고, 레벨업을 통해 성장하며 새로운 스킬을 습득할 수 있습니다.
*   **상태 이상 및 버프/디버프 시스템**:
    *   **독**: 매 턴 지속적인 피해를 입습니다.
    *   **기절**: 일정 턴 동안 행동 불능 상태가 됩니다.
    *   **공격력/방어력 버프 및 디버프**: 특정 능력치를 일정 시간 동안 증가시키거나 감소시킵니다.
    *   다양한 효과(아이콘, 지속시간, 로그 메시지 등)를 가진 상태 이상을 아이템이나 스킬을 통해 적용하거나 치료할 수 있습니다.
*   **아이템 및 장비 관리**: 다양한 소비 아이템, 무기, 방어구, 장신구를 획득하고 장착하여 캐릭터의 능력치를 강화할 수 있습니다.
*   **상점 시스템**: 마을 등 특정 장소에서 아이템을 구매하거나 판매할 수 있습니다.
*   **스킬 시스템**: MP를 소모하여 다양한 효과를 가진 스킬을 전투 및 비전투 상황에서 사용할 수 있습니다. 스킬에는 직접적인 피해/회복 효과 외에도 상태 이상 부여 효과가 포함될 수 있습니다.
*   **동적 게임 로그**: 게임 내 모든 중요한 사건, 대화, 전투 상황, 상태 이상 변화 등을 기록하여 플레이어가 진행 상황을 쉽게 파악할 수 있도록 합니다.
*   **반응형 UI**: Tailwind CSS를 사용하여 다양한 화면 크기에서 플레이할 수 있도록 반응형 UI를 제공합니다.
*   **스크립트 가져오기**: 사용자가 직접 작성한 JSON 스크립트 파일을 불러와 게임을 플레이할 수 있습니다.
*   **능력치 시각화**: Recharts 라이브러리를 사용하여 플레이어의 주요 능력치를 레이더 차트로 시각화하여 보여줍니다.
*   **미니맵 기능**: 현재 스테이지의 장면 흐름을 시각적으로 보여주는 미니맵을 제공하여 플레이어가 진행 상황과 구조를 파악하는 데 도움을 줍니다. 현재 장면과 방문한 장면이 구분되어 표시됩니다.
*   **전투 위임 모드**: 전투 시 플레이어가 직접 조작하지 않고, 기본적인 공격 행동을 자동으로 수행하도록 하는 위임 모드를 제공합니다.
*   **게임 상태 저장/불러오기**: 현재 플레이 중인 게임의 전체 상태(플레이어 능력치, 인벤토리, 진행 상황 등)를 로컬 스토리지에 저장하고, 이후에 이어서 플레이할 수 있는 기능을 제공합니다.
*   **기본 시나리오 제공 및 내보내기**: "잊혀진 영역의 연대기" 테마의 기본 시나리오를 제공하며, 사용자가 이를 참고하거나 수정할 수 있도록 원본 스크립트 파일을 내보내는 기능을 지원합니다.

## 기술 스택

*   **Frontend**: React, TypeScript
*   **Styling**: Tailwind CSS
*   **Charting**: Recharts
*   **Dependencies Management**: esm.sh (브라우저에서 직접 ES 모듈 로드)

## 프로젝트 구조

```
.
├── public/
│   └── script.json           # 기본 게임 시나리오 파일
├── src/
│   ├── components/           # React UI 컴포넌트
│   │   ├── App.tsx             # 메인 애플리케이션 컴포넌트
│   │   ├── BottomBar.tsx       # 하단 액션 바
│   │   ├── GameLogPanel.tsx    # 게임 로그 표시 패널
│   │   ├── GameScreen.tsx      # 메인 게임 화면 (장면, 전투 등 표시)
│   │   ├── InventoryModal.tsx  # 인벤토리 모달
│   │   ├── LoadingSpinner.tsx  # 로딩 스피너
│   │   ├── MinimapPanel.tsx    # 미니맵 표시 패널
│   │   ├── PlayerStatsPanel.tsx # 플레이어 상태 표시 패널
│   │   ├── ScriptImporter.tsx  # 스크립트 가져오기 컴포넌트
│   │   ├── ShopModal.tsx       # 상점 모달
│   │   ├── SkillModal.tsx      # 스킬 모달
│   │   ├── StartScreen.tsx     # 시작 화면
│   │   └── StatsChartModal.tsx # 능력치 차트 모달
│   ├── hooks/
│   │   └── useGameLogic.ts     # 핵심 게임 로직 및 상태 관리 훅
│   ├── services/
│   │   └── geminiService.ts    # Gemini API 연동 서비스 (현재 플레이스홀더)
│   ├── utils/
│   │   └── localStorage.ts     # 로컬 스토리지 유틸리티 함수
│   ├── constants.ts            # 게임 상수, 아이템/스킬 기본 정의
│   └── types.ts                # TypeScript 타입 정의
├── index.html                  # 메인 HTML 파일
├── index.tsx                   # React 애플리케이션 진입점
├── metadata.json               # 애플리케이션 메타데이터
└── README.md                   # 프로젝트 설명 파일
```

## 시작하기

이 애플리케이션은 웹 브라우저에서 직접 실행되도록 설계되었습니다. 별도의 빌드 과정이나 서버 설정이 필요하지 않습니다.

1.  **파일 다운로드**: 프로젝트의 모든 파일을 다운로드합니다.
2.  **`index.html` 실행**: 다운로드한 폴더에서 `index.html` 파일을 웹 브라우저로 엽니다. (예: 파일을 브라우저 창으로 드래그 앤 드롭하거나, 로컬 웹 서버를 통해 제공)


## 스크립팅 가이드

게임의 모든 내용은 `script.json` (또는 사용자가 직접 제공하는 JSON 파일)에 의해 정의됩니다. 스크립트의 주요 구조는 다음과 같습니다.

### 1. `worldSettings`

게임의 전반적인 세계관 설정을 정의합니다.

*   `title`: 게임 제목
*   `description`: 게임에 대한 간략한 설명
*   `mainConflict` (선택 사항): 주요 갈등 구조
*   `keyLocations` (선택 사항): 주요 장소 목록 (쉼표로 구분)

### 2. `stages`

게임은 여러 `stage`로 구성되며, 각 스테이지는 독립적인 이야기 단위를 가질 수 있습니다.

*   `id`: 스테이지의 고유 ID
*   `title`: 스테이지 제목
*   `settingDescription`: 스테이지의 배경 설정 및 분위기 설명
*   `characters`: 해당 스테이지에 등장하는 캐릭터 목록 (아래 캐릭터 섹션 참조)
*   `scenes`: 해당 스테이지를 구성하는 장면 목록 (아래 장면 섹션 참조)

### 3. `characters` (스테이지 내 정의)

스테이지에 등장하는 플레이어 캐릭터(PC), NPC, 몬스터 등을 정의합니다.

*   `id`: 캐릭터 고유 ID
*   `name`: 캐릭터 이름
*   `type`: 캐릭터 유형 ( `플레이어 캐릭터`, `NPC`, `일반 몬스터`, `보스 몬스터` 중 하나 - `CharacterType` enum 참조)
*   `description`: 캐릭터에 대한 설명
*   `hp`, `maxHp`, `attack`, `defense`, `speed`, `critChance` (몬스터용, 선택 사항): 몬스터의 기본 능력치. 미지정 시 `constants.ts`의 기본값이 사용됩니다. `critChance`는 치명타 확률(%)입니다.
*   `skills` (몬스터용, 선택 사항): 몬스터가 사용하는 스킬 ID 목록

### 4. `scenes` (스테이지 내 정의)

스테이지의 각 장면을 정의합니다. 장면은 게임 흐름의 기본 단위입니다.

*   `id`: 장면 고유 ID
*   `stageId`: 이 장면이 속한 스테이지의 ID
*   `title`: 장면 제목
*   `type`: 장면 유형 (`SceneType` enum 참조):
    *   `NARRATION`: 설명 텍스트를 보여줍니다.
    *   `LOCATION_CHANGE`: 새로운 장소로 이동했음을 알립니다. (`newLocationName` 속성 사용)
    *   `TOWN`: 마을과 같은 안전 구역. 상점 이용, 휴식 등의 옵션이 제공됩니다.
    *   `DIALOGUE`: NPC와 대화합니다. (`characterIds` 배열에 NPC ID 지정)
    *   `COMBAT_NORMAL`: 일반 몬스터와 전투합니다. (`combatDetails` 속성 사용)
    *   `COMBAT_BOSS`: 보스 몬스터와 전투합니다. (`combatDetails` 속성 사용)
    *   `ITEM_GET`: 아이템을 획득합니다. (`item` 속성에 아이템 이름 또는 ID 지정)
    *   `CHOICE`: 플레이어에게 선택지를 제공합니다. (`choices` 배열 사용)
*   `content`: 장면에 대한 설명, 대사, 상황 묘사 등
*   `characterIds`: 장면에 등장하는 캐릭터 ID 목록 (주로 `DIALOGUE` 타입에서 사용)
*   `nextSceneId`: 이 장면 이후에 이어질 다음 장면의 ID. `null`이면 현재 스테이지의 마지막 장면이거나, `CHOICE` 타입에서는 선택지에 따라 다음 장면이 결정됩니다.
*   `newLocationName` (`LOCATION_CHANGE` 타입 전용, 선택 사항): 변경된 새 위치의 이름.
*   `combatDetails` (`COMBAT_NORMAL`, `COMBAT_BOSS` 타입 전용, 선택 사항):
    *   `enemyCharacterIds`: 전투할 적 캐릭터 ID 목록
    *   `reward` (문자열 형태, 현재는 설명용): 전투 승리 시 보상 설명
*   `item` (`ITEM_GET` 타입 전용, 선택 사항): 획득할 아이템의 ID 또는 이름. `constants.ts`의 `ALL_ITEM_DEFINITIONS`에 정의된 아이템을 참조합니다.
*   `choices` (`CHOICE` 타입 전용, 선택 사항):
    *   `id`: 선택지 고유 ID
    *   `text`: 플레이어에게 보여줄 선택지 텍스트
    *   `nextSceneId`: 이 선택지를 골랐을 때 이어질 다음 장면의 ID

### 아이템 및 스킬 정의

게임 내 모든 아이템과 스킬은 `src/constants.ts` 파일에 정의되어 있습니다.

*   **아이템**: `GameItem` 인터페이스를 따르며, ID, 이름, 설명, 타입, 효과, 가격 등을 가집니다. `ALL_ITEM_DEFINITIONS` 객체에 모든 아이템이 등록됩니다.
    *   `effects.appliesEffect`: 아이템 사용 시 대상에게 적용할 상태 이상 효과를 정의합니다 (`effectId`, `duration`, `potency`).
    *   `effects.curesEffect`: 아이템 사용 시 치료할 상태 이상 효과 ID 목록을 정의합니다.
*   **스킬**: `Skill` 인터페이스를 따르며, ID, 이름, 설명, MP 소모, 효과치, 효과 타입, 대상 타입 등을 가집니다. `ALL_SKILL_DEFINITIONS` 객체에 모든 스킬이 등록됩니다.
    *   `appliesStatusEffect`: 스킬 사용 시 대상에게 적용할 상태 이상 효과를 정의합니다 (`effectId`, `duration`, `potency`, `chance`). `chance`는 0과 1 사이의 값으로, 상태 이상 적용 확률을 나타냅니다 (기본값: 1).

## 플레이 방법

1.  **게임 시작**:
    *   **새 게임 시작 (기본)**: "새 게임 시작 (기본)" 버튼을 클릭하여 `public/script.json`에 정의된 기본 시나리오로 게임을 시작합니다. 저장된 데이터가 있을 경우, 초기화 확인 팝업이 나타납니다.
    *   **커스텀 시나리오 불러오기**: "커스텀 시나리오 불러오기" 버튼을 클릭하여 로컬에 있는 JSON 형식의 게임 스크립트 파일을 선택하여 로드합니다.
    *   **저장된 게임 불러오기**: 이전에 "게임 저장"을 통해 저장한 게임이 있다면, "저장된 게임 불러오기" 버튼을 통해 해당 지점부터 이어서 플레이할 수 있습니다.
    *   **오리지널 시나리오 내보내기**: 기본 제공되는 `script.json` 파일을 다운로드하여 스크립트 작성의 참고 자료로 활용할 수 있습니다.

2.  **게임 진행**:
    *   화면 중앙의 **게임 화면(Game Screen)** 패널에 현재 장면의 내용이 표시됩니다.
    *   **게임 로그(Game Log Panel)** 패널에는 진행 상황, 대화, 전투 메시지 등이 기록됩니다.
    *   **플레이어 상태(Player Stats Panel)** 패널에서 캐릭터의 현재 능력치, 장비, 습득한 스킬, 활성화된 상태 이상 등을 확인할 수 있습니다.
    *   **미니맵(Minimap Panel)**: 플레이어 상태 패널 아래에 위치하며, 현재 스테이지의 장면 흐름을 시각적으로 보여줍니다. 현재 위치한 장면과 이미 방문한 장면이 강조 표시됩니다.

3.  **상호작용**:
    *   **내레이션/대화**: "계속하기" 버튼을 눌러 다음 내용으로 진행합니다.
    *   **선택지**: 제시된 선택지 중 하나를 클릭하여 이야기를 분기시킵니다.
    *   **마을**: "상점 이용하기", "휴식하기 (HP/MP 회복)", "마을 떠나기" 등의 행동을 선택할 수 있습니다.
    *   **전투 후 (일반 전투)**: "다시 싸우기"를 선택하여 같은 적과 다시 전투하거나, "계속 진행"을 눌러 다음 장면으로 넘어갈 수 있습니다.

4.  **전투**:
    *   **턴 순서**: 전투 시작 시, 캐릭터들의 '속도(Speed)' 능력치에 따라 해당 라운드의 행동 순서가 결정됩니다.
    *   **공격**: 기본적인 물리 공격을 합니다. 대상을 선택해야 합니다.
        *   **치명타(Critical Hit)**: 캐릭터의 '치명타 확률(Crit Chance)'에 따라 일정 확률로 더 큰 피해를 입힙니다.
        *   **빗나감(Miss)**: 공격자와 방어자의 '행운(Luck)' 능력치에 따라 공격이 빗나갈 수 있습니다.
    *   **스킬**: 스킬 목록을 열어 사용할 스킬을 선택합니다. 일부 스킬은 대상을 지정해야 합니다. 스킬은 피해, 회복, 버프/디버프, 상태 이상 부여 등 다양한 효과를 가집니다.
    *   **아이템**: 인벤토리를 열어 전투 중 사용할 수 있는 소비 아이템을 선택합니다.
    *   **도망**: 전투에서 도망을 시도합니다. 보스 전투에서는 불가능할 수 있으며, 성공 확률이 있습니다.
    *   **상태 이상**: '독'에 걸리면 매 턴 피해를 입고, '기절'에 걸리면 행동 불능이 됩니다. 버프/디버프는 특정 능력치를 변화시킵니다. 적들도 상태 이상을 사용하거나 상태 이상에 걸릴 수 있습니다.
    *   **적의 행동**: 적들도 일반 공격 외에 다양한 스킬을 사용하여 플레이어를 공격하거나 자신에게 버프를 겁니다.

5.  **하단 바 (Bottom Bar)**:
    *   **가방**: 인벤토리를 열어 소지한 아이템을 확인하고, 소비 아이템을 사용하거나 장비를 장착/해제할 수 있습니다. 현재 소지 골드도 표시됩니다.
    *   **스킬**: 습득한 스킬 목록을 확인하고, 스킬을 사용할 수 있습니다 (전투 중/비전투 중 사용 가능 여부 스킬마다 다름).
    *   **능력치**: 플레이어의 주요 능력치를 레이더 차트로 시각화하여 보여줍니다.
    *   **게임 저장**: 현재 게임의 진행 상태(플레이어 정보, 인벤토리, 현재 위치 등)를 브라우저의 로컬 스토리지에 저장합니다.
    *   **전투 위임 ON/OFF**: 전투 위임 모드를 켜고 끌 수 있습니다. 활성화 시, 전투 중 플레이어 턴이 되면 자동으로 기본 공격을 수행합니다. (약 1.5초 후 자동 행동)
    *   **메인 메뉴**: 현재 게임을 초기화하고 시작 화면으로 돌아갑니다. 저장되지 않은 진행 상황은 사라집니다.

## 향후 개선 사항 (제안)

*   **더욱 다양한 상태 이상 및 복잡한 상호작용 구현**: 예: 혼란, 침묵, 특정 속성 강화/약화 등.
*   **고급 스킬 트리 및 직업 시스템**.
*   **사운드 및 음악 효과 추가**.
*   **UI/UX 개선**: 전투 애니메이션, 아이템/스킬 아이콘 다양화 등.

---

이 README 파일이 프로젝트를 이해하고 사용하는 데 도움이 되기를 바랍니다!
